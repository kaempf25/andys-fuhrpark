<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fahrzeugpark Andy</title>
    <!-- React und ReactDOM als UMD-Bundles -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <!-- Babel für In-Browser-Compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS für schnelles, buntes Styling -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100">
    <div id="root"></div>
    <script type="text/babel">
      /* --------------------------
         1) Garagen und Daten
      --------------------------- */

      const garages = [
        "Spexarder_Strasse",
        "Sparkasse_Avenwedde",
        "Mumprow",
        "Amrumweg"
      ];

      // Hier wurden die Dateinamen an die GitHub-Dateien angepasst:
      // (z. B. "Mercedes w113.jpeg" statt "Mercedes_W113.jpeg")
      const vehiclesDataInitial = [
        {
          id: "mercedes-w113",
          name: "Mercedes W113 230 SL (Pagode)",
          type: "Auto",
          technical: "Klassischer 230 SL mit 2,3-Liter Reihen-Sechszylinder und ca. 150 PS.",
          imageUrl: "./Mercedes w113.jpeg",
          marketPrice: "120.000€",
          garage: "Spexarder_Strasse",
          note: "",
          specs: {
            Motor: "2,3L Reihen-Sechszylinder",
            Leistung: "150 PS",
            Baujahr: "1963",
            Besonderheiten: "Ikonisches Pagoden-Design, zeitloses Erscheinungsbild"
          }
        },
        {
          id: "mercedes-r107",
          name: "Mercedes R107 560 SL",
          type: "Auto",
          technical: "Luxuriöses Cabriolet mit 5,6-Liter V8 und ca. 230 PS.",
          imageUrl: "./Mercedes R107.jpeg",
          marketPrice: "150.000€",
          garage: "Sparkasse_Avenwedde",
          note: "",
          specs: {
            Motor: "5,6L V8",
            Leistung: "230 PS",
            Baujahr: "1986",
            Besonderheiten: "Hochkomfort, klassisches Design, luxuriöse Ausstattung"
          }
        },
        {
          id: "mercedes-r129",
          name: "Mercedes R129 500 SL",
          type: "Auto",
          technical: "Modernes Cabriolet mit 5,0-Liter V8 und ca. 326 PS.",
          imageUrl: "./Mercedes R129.jpeg",
          marketPrice: "20.000€",
          garage: "Spexarder_Strasse",
          note: "",
          specs: {
            Motor: "5,0L V8",
            Leistung: "326 PS",
            Baujahr: "1994",
            Besonderheiten: "Fortschrittliche Technik, elegantes Design, moderne Sicherheit"
          }
        },
        {
          id: "mercedes-w208",
          name: "Mercedes W208 230 CLK",
          type: "Auto",
          technical: "Kompakter 230 CLK - Kompressor - mit dynamischem Design.",
          imageUrl: "./Mervedes W208 CLK.jpeg",
          marketPrice: "8.000€",
          garage: "Sparkasse_Avenwedde",
          note: "",
          specs: {
            Motor: "2,3L",
            Leistung: "197 PS",
            Baujahr: "1999",
            Besonderheiten: "Kompakt, zuverlässig, dynamisch"
          }
        },
        {
          id: "vw-t6",
          name: "VW Bus T6 2.0 TDI (2017)",
          type: "Auto",
          technical: "Robuster VW Bus (2,0-Liter Diesel, ca. 150 PS) – ideal für Reisen.",
          imageUrl: "./VW T6.jpeg",
          marketPrice: "80.000€",
          garage: "Mumprow",
          note: "",
          specs: {
            Motor: "2,0L Diesel",
            Leistung: "150 PS",
            Baujahr: "2017",
            Besonderheiten: "Geräumig, vielseitig, ideal für Familienreisen"
          }
        },
        {
          id: "man-traktor",
          name: "MAN Traktor 2N1",
          type: "Landmaschine",
          technical: "Robuster Traktor (ca. 1,6 -Liter Diesel, ca. 28 PS) – ideal für Landwirtschaft.",
          imageUrl: "./man-traktor.jpeg",
          marketPrice: "4.000€",
          garage: "Amrumweg",
          note: "",
          specs: {
            Motor: "ca. 1,6 L Diesel",
            Leistung: "ca. 28 PS",
            Baujahr: "1962",
            Besonderheiten: "Extrem robust, wartungsfreundlich, ideal für den harten Einsatz"
          }
        },
        {
          id: "bmw-r80",
          name: "BMW R80",
          type: "Motorrad",
          technical: "Kultiges Motorrad (800cc, ca. 70 PS) – begehrtes Sammlerstück.",
          imageUrl: "./BMW R80.jpeg",
          marketPrice: "5.000€",
          garage: "Spexarder_Strasse",
          note: "",
          specs: {
            Motor: "800cc",
            Leistung: "50 PS",
            Baujahr: "1982",
            Besonderheiten: "Robust, zeitlos, klassischer Look"
          }
        },
        {
          id: "bmw-r1200gs",
          name: "BMW R1200 GS",
          type: "Motorrad",
          technical: "Modernes Adventure-Bike (1170cc, ca. 125 PS), ideal für Touren und Offroad.",
          imageUrl: "./BMW R1200GS.jpeg",
          marketPrice: "12.000€",
          garage: "Sparkasse_Avenwedde",
          note: "",
          specs: {
            Motor: "1170cc",
            Leistung: "125 PS",
            Baujahr: "2014",
            Besonderheiten: "Geländegängig, moderner Komfort, innovative Elektronik"
          }
        },
        {
          id: "vespa-gts300",
          name: "Vespa GTS 300",
          type: "Roller",
          technical: "Stilvoller Roller (278cc, ca. 23 PS), vereint klassisches Design mit moderner Technik.",
          imageUrl: "./Vespa 300.jpeg",
          marketPrice: "4.000€",
          garage: "Mumprow",
          note: "",
          specs: {
            Motor: "278cc",
            Leistung: "23 PS",
            Baujahr: "2014",
            Besonderheiten: "Hoher Fahrkomfort, ikonisches Design, wendig"
          }
        }
      ];

      // Wartungsaufgaben (global)
      const defaultMaintenanceTasks = [
        "Ölwechsel", "Zündkerzen prüfen", "Bremsen kontrollieren", "Reifendruck prüfen"
      ];

      /* --------------------------
         2) Haupt-App-Komponente
      --------------------------- */
      function FuhrparkApp() {
        // *** HINWEIS: Dies löscht beim Laden einmalig alle alten localStorage-Daten,
        // um sicherzustellen, dass die hier definierten Werte wirklich angezeigt werden. ***
        // Entferne diese Zeilen, sobald du möchtest, dass Änderungen (z. B. neu hochgeladene Bilder)
        // dauerhaft erhalten bleiben.
        React.useEffect(() => {
          localStorage.removeItem('vehiclesData');
          localStorage.removeItem('maintenanceData');
          localStorage.removeItem('maintenanceTasks');
        }, []);

        // Zustand für Fahrzeuge, Wartungsdaten, Wartungsdienste
        const [vehiclesData, setVehiclesData] = React.useState(vehiclesDataInitial);
        const [maintenanceData, setMaintenanceData] = React.useState({});
        const [maintenanceTasks, setMaintenanceTasks] = React.useState(defaultMaintenanceTasks);

        // Aktives Fahrzeug, ausgewähltes Jahr, Filter
        const [activeVehicle, setActiveVehicle] = React.useState(vehiclesData[0].id);
        const [selectedYear, setSelectedYear] = React.useState(2025);
        const [filterType, setFilterType] = React.useState("Alle");

        // Speichere Zustand bei Änderungen in localStorage
        React.useEffect(() => {
          localStorage.setItem('vehiclesData', JSON.stringify(vehiclesData));
        }, [vehiclesData]);
        React.useEffect(() => {
          localStorage.setItem('maintenanceData', JSON.stringify(maintenanceData));
        }, [maintenanceData]);
        React.useEffect(() => {
          localStorage.setItem('maintenanceTasks', JSON.stringify(maintenanceTasks));
        }, [maintenanceTasks]);

        // Wartungsaufgabe umschalten
        const handleTaskToggle = (vehicleId, year, task) => {
          setMaintenanceData(prev => {
            const vehicleData = prev[vehicleId] || {};
            const yearData = vehicleData[year] || {};
            const currentStatus = yearData[task];
            const newYearData = { ...yearData, [task]: currentStatus ? null : new Date().toISOString() };
            return {
              ...prev,
              [vehicleId]: {
                ...vehicleData,
                [year]: newYearData
              }
            };
          });
        };

        // Aktives Fahrzeug-Objekt
        const activeVehicleData = vehiclesData.find(v => v.id === activeVehicle);

        // Jahre von 2025 bis 2050
        const years = [];
        for (let y = 2025; y <= 2050; y++) {
          years.push(y);
        }

        // Nach Fahrzeugtyp filtern
        const filteredVehicles = vehiclesData.filter(vehicle =>
          filterType === "Alle" ? true : vehicle.type === filterType
        );

        // Neuen Wartungsdienst hinzufügen
        const handleAddMaintenanceTask = () => {
          const newTask = prompt("Neuen Wartungsdienst eingeben:");
          if (newTask) {
            const updatedTasks = [...maintenanceTasks, newTask];
            setMaintenanceTasks(updatedTasks);
          }
        };

        // Notiz ändern
        const handleNoteChange = (e) => {
          const newNote = e.target.value;
          setVehiclesData(vehiclesData.map(vehicle =>
            vehicle.id === activeVehicle ? { ...vehicle, note: newNote } : vehicle
          ));
        };

        // Bild hochladen
        const handleImageUpload = (e) => {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onloadend = () => {
              const newImageUrl = reader.result;
              const updatedVehicles = vehiclesData.map(vehicle => {
                if (vehicle.id === activeVehicle) {
                  return { ...vehicle, imageUrl: newImageUrl };
                }
                return vehicle;
              });
              setVehiclesData(updatedVehicles);
            };
            reader.readAsDataURL(file);
          }
        };

        /* --------------------------
           3) Präsentations-Komponenten
        --------------------------- */
        function VehicleCard({ vehicle, isActive, onClick }) {
          return (
            <div 
              className={`border rounded-lg shadow-lg p-4 bg-gradient-to-br from-blue-100 to-purple-100 cursor-pointer transform hover:scale-105 transition-transform ${isActive ? 'border-green-600' : 'border-gray-300'}`}
              onClick={onClick}
            >
              <img src={vehicle.imageUrl} alt={vehicle.name} className="w-full h-40 object-cover rounded" />
              <h2 className="text-xl font-bold mt-2 text-blue-800">{vehicle.name}</h2>
              <p className="text-sm text-gray-700">{vehicle.technical}</p>
              <div className="mt-2 text-sm text-gray-800">
                <p><strong>Motor:</strong> {vehicle.specs.Motor}</p>
                <p><strong>Leistung:</strong> {vehicle.specs.Leistung}</p>
                <p><strong>Baujahr:</strong> {vehicle.specs.Baujahr}</p>
                <p><strong>Besonderheiten:</strong> {vehicle.specs.Besonderheiten}</p>
              </div>
              <div className="mt-2 text-sm">
                <p><strong>Marktpreis:</strong> {vehicle.marketPrice}</p>
                <p><strong>Garage:</strong> {vehicle.garage.replace(/_/g, " ")}</p>
              </div>
            </div>
          );
        }

        /* --------------------------
           4) Render-Funktion
        --------------------------- */
        return (
          <div className="p-4">
            <h1 className="text-4xl font-extrabold mb-6 text-center bg-gradient-to-r from-purple-600 to-pink-500 text-white py-4 rounded">
              Fahrzeugpark Andy
            </h1>
            
            {/* Filter nach Fahrzeugtyp */}
            <div className="mb-4 flex items-center justify-center space-x-4">
              <label className="font-semibold text-lg">Fahrzeugtyp:</label>
              <select
                value={filterType}
                onChange={(e) => setFilterType(e.target.value)}
                className="border rounded px-2 py-1"
              >
                <option value="Alle">Alle</option>
                <option value="Auto">Auto</option>
                <option value="Motorrad">Motorrad</option>
                <option value="Roller">Roller</option>
                <option value="Landmaschine">Landmaschine</option>
              </select>
            </div>

            {/* Grid der Fahrzeugkarten */}
            <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-8">
              {filteredVehicles.map(vehicle => (
                <VehicleCard 
                  key={vehicle.id} 
                  vehicle={vehicle} 
                  isActive={vehicle.id === activeVehicle} 
                  onClick={() => setActiveVehicle(vehicle.id)}
                />
              ))}
            </div>

            {/* Detailansicht aktives Fahrzeug */}
            {activeVehicleData && (
              <div className="mb-6 border p-4 rounded shadow bg-white">
                <h2 className="text-2xl font-bold mb-4">Detailansicht: {activeVehicleData.name}</h2>
                <img
                  src={activeVehicleData.imageUrl}
                  alt={activeVehicleData.name}
                  className="w-full h-64 mb-4 object-contain border"
                />
                <div className="mb-4">
                  <label className="mr-2 font-semibold">Marktpreis:</label>
                  <input
                    type="text"
                    value={activeVehicleData.marketPrice}
                    onChange={(e) => {
                      const newPrice = e.target.value;
                      setVehiclesData(vehiclesData.map(vehicle =>
                        vehicle.id === activeVehicle ? { ...vehicle, marketPrice: newPrice } : vehicle
                      ));
                    }}
                    className="border rounded px-2 py-1"
                  />
                </div>
                <div className="mb-4">
                  <label className="mr-2 font-semibold">Garage:</label>
                  <select
                    value={activeVehicleData.garage}
                    onChange={(e) => {
                      const newGarage = e.target.value;
                      setVehiclesData(vehiclesData.map(vehicle =>
                        vehicle.id === activeVehicle ? { ...vehicle, garage: newGarage } : vehicle
                      ));
                    }}
                    className="border rounded px-2 py-1"
                  >
                    {garages.map((g, idx) => (
                      <option key={idx} value={g}>{g.replace(/_/g, " ")}</option>
                    ))}
                  </select>
                </div>
                <div className="mb-4">
                  <label className="block font-semibold mb-1">Notizen:</label>
                  <textarea
                    value={activeVehicleData.note}
                    onChange={handleNoteChange}
                    className="w-full border rounded p-2"
                    placeholder="Hier kannst du Notizen zum Fahrzeug eingeben..."
                  />
                </div>
                <div className="mb-4">
                  <label className="mr-2 font-semibold">Foto ändern:</label>
                  <input
                    type="file"
                    accept="image/*"
                    onChange={handleImageUpload}
                    className="border rounded px-2 py-1"
                  />
                </div>
              </div>
            )}

            {/* Wartungskalender */}
            <div className="mb-6">
              <label className="mr-2 font-semibold">Wartungskalender Jahr:</label>
              <select
                value={selectedYear}
                onChange={(e) => setSelectedYear(parseInt(e.target.value))}
                className="border rounded px-2 py-1"
              >
                {years.map(year => (
                  <option key={year} value={year}>{year}</option>
                ))}
              </select>
            </div>
            <div className="mb-6 bg-white p-4 rounded shadow">
              <h3 className="text-lg font-bold mb-2">Wartungsaufgaben für {selectedYear}</h3>
              <ul>
                {maintenanceTasks.map(task => {
                  const completedDate = maintenanceData[activeVehicle] &&
                    maintenanceData[activeVehicle][selectedYear] &&
                    maintenanceData[activeVehicle][selectedYear][task];
                  return (
                    <li key={task} className="mb-2">
                      <label>
                        <input
                          type="checkbox"
                          checked={!!completedDate}
                          onChange={() => handleTaskToggle(activeVehicle, selectedYear, task)}
                          className="mr-2"
                        />
                        {task}{" "}
                        {completedDate && (
                          <span className="text-green-600">
                            (Erledigt am {new Date(completedDate).toLocaleDateString()})
                          </span>
                        )}
                      </label>
                    </li>
                  );
                })}
              </ul>
              <button
                onClick={handleAddMaintenanceTask}
                className="bg-blue-600 text-white px-4 py-2 rounded mt-2"
              >
                Neuen Wartungsdienst hinzufügen
              </button>
            </div>
          </div>
        );
      }

      // App rendern
      ReactDOM.render(<FuhrparkApp />, document.getElementById('root'));
    </script>
  </body>
</html>
